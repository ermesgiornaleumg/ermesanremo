<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Liveblog | ErmeSanremo</title>
  <meta name="description" content="Liveblog ErmeSanremo: aggiornamenti in tempo reale dalla redazione." />
<meta name="robots" content="index, follow">
  <link rel="canonical" href="https://ermesanremo.ermes-umg.it/liveblog/">

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XVPFB6T2W7"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XVPFB6T2W7');
  </script>

  <style>
    :root{
      --bg:#0b0b12;
      --text:#f2f2ff;
      --muted:#b8b8d6;
      --border:rgba(255,255,255,.12);
      --shadow:0 12px 30px rgba(0,0,0,.35);
      --accent:#7c5cff;
      --accent2:#19d3ff;
    }

    *{box-sizing:border-box;}
    html, body { background: var(--bg) !important; color: var(--text) !important; }

    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:
        radial-gradient(1200px 600px at 20% -10%, rgba(124,92,255,.25), transparent 55%),
        radial-gradient(900px 500px at 90% 10%, rgba(25,211,255,.18), transparent 50%),
        linear-gradient(180deg,#0b0b12,#07070c 70%) !important;
      color:var(--text) !important;
      line-height:1.6;
    }

    .wrap{max-width:950px;margin:0 auto;padding:26px 18px;}
    a{color:var(--muted) !important;text-decoration:none;font-size:14px}

    h1{margin:10px 0 6px;font-size:34px;letter-spacing:.2px;color:var(--text) !important}
    .meta{color:var(--muted) !important;font-size:14px;margin:0 0 18px}

    .card{
      background:rgba(255,255,255,.05) !important;
      border:1px solid var(--border) !important;
      border-radius:18px;
      padding:18px;
      box-shadow:var(--shadow);
      color:var(--text) !important;
    }

    .topbar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-bottom:10px;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:8px 12px;
      border:1px solid var(--border) !important;
      border-radius:999px;
      background:rgba(255,255,255,.06) !important;
      color:var(--text) !important;
      font-size:13px;
    }

    .dot{
      width:10px;height:10px;border-radius:999px;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      box-shadow:0 0 18px rgba(124,92,255,.55);
      flex:0 0 auto;
    }

    .liveBadge{
      margin-left:6px;
      padding:4px 8px;
      border-radius:999px;
      font-weight:900;
      letter-spacing:.6px;
      font-size:11px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(255, 0, 80, .18);
      color:var(--text) !important;
      animation: pulse 1.2s infinite;
    }
    @keyframes pulse{
      0%,100%{ transform: scale(1); opacity: .95; }
      50%{ transform: scale(1.06); opacity: .55; }
    }

    .btn{
      padding:10px 12px;
      border-radius:12px;
      background:#ffffff !important;
      color:#0b0b12 !important;
      font-weight:800;
      font-size:14px;
      border:0;
      cursor:pointer;
    }

    .post{
      border:1px solid var(--border) !important;
      border-radius:16px;
      padding:14px;
      background:rgba(0,0,0,.28) !important;
      margin-top:12px;
      color:var(--text) !important;
    }

    .post.new{
      outline:2px solid rgba(124,92,255,.40);
      box-shadow:0 0 0 4px rgba(25,211,255,.10);
    }

    .posthead{
      display:flex;
      justify-content:space-between;
      gap:10px;
      color:var(--muted) !important;
      font-size:13px;
      margin-bottom:6px;
    }

    .author{
      font-weight:900;
      color:var(--text) !important;
    }

    .text{
      white-space:pre-wrap;
      font-size:16px;
      color:var(--text) !important;
    }

    .empty{
      color:var(--muted) !important;
      font-size:14px;
      margin-top:10px;
    }

    /* contenuto statico: aiuta SEO e toglie soft 404 */
    .infoBox{
      margin:14px 0 18px;
      padding:14px;
      border:1px solid var(--border);
      border-radius:16px;
      background:rgba(255,255,255,.03);
    }
    .infoBox h2{
      margin:0 0 8px;
      font-size:18px;
      color:var(--text);
    }
  </style>

  <script type="application/ld+json" id="live-schema">
  {
    "@context": "https://schema.org",
    "@type": "LiveBlogPosting",
    "headline": "Liveblog ErmeSanremo 2026",
    "description": "Aggiornamenti in tempo reale dal Festival di Sanremo 2026 a cura della redazione ERMES.",
    "url": "https://ermesanremo.ermes-umg.it/liveblog/",
    "coverageStartTime": "2026-02-25T20:00:00+01:00",
    "coverageEndTime": "2026-02-25T23:59:00+01:00",
    "datePublished": "2026-02-25T20:00:00+01:00",
    "dateModified": "2026-02-25T20:00:00+01:00",
    "author": { "@type": "Organization", "name": "ERMES Giornalino UMG" },
    "publisher": {
      "@type": "Organization",
      "name": "ERMES Giornalino UMG",
      "logo": {
        "@type": "ImageObject",
        "url": "https://blogger.googleusercontent.com/img/a/AVvXsEh4ybQVv-oNn7VReyNrrUF7rGwr1Nu8-gtDdMej0le2IxpMFsLJkDOFNBMVyjFexEAFmZyPjzaSQqTtCNs2j8eHU3D82Y57yls9hnZAyTo5gMafzKxhWjCi4VxjHmDG-Jp-rUzui8cOhuT_tKJwWBf0pdCMcBhOvKSRQKRJrPMddmMkkZhn3cUdhbMZqcM=s255"
      }
    },
    "isAccessibleForFree": true,
    "inLanguage": "it-IT"
  }
  </script>
</head>

<body>
  <div class="wrap">
    <a href="../index.html">← Torna alla Home</a>

    <h1>Liveblog</h1>
    <p class="meta">Aggiornamenti live in tempo reale. Auto-refresh ogni <strong>20s</strong>.</p>

    <!-- ✅ contenuto statico per evitare Soft 404 -->
<section class="infoBox">
  <h2>Liveblog ufficiale ErmeSanremo 2026</h2>

  <p>
    Segui qui il liveblog del Festival di Sanremo 2026 a cura della redazione ERMES.
    Aggiornamenti in tempo reale su esibizioni, classifica provvisoria,
    ospiti, momenti chiave e commenti dalla sala stampa.
  </p>

  <p>
    La pagina viene aggiornata automaticamente ogni 20 secondi
    durante la diretta televisiva.
  </p>

  <p>
    Approfondimenti disponibili nelle sezioni:
    <a href="https://ermesanremo.ermes-umg.it/serate/serata-1.html">Serata 1</a>,
    <a href="https://ermesanremo.ermes-umg.it/sondaggio/">Sondaggio ufficiale</a>,
    <a href="https://ermesanremo.ermes-umg.it/">Calendario completo</a>.
  </p>
</section>

    <div class="card">
      <div class="topbar">
        <div class="pill" id="status">
          <span class="dot"></span>
          <span>Caricamento…</span>
          <span class="liveBadge">LIVE</span>
        </div>
        <button class="btn" id="reload">Aggiorna ora</button>
      </div>

      <!-- ✅ placeholder statico: Google vede contenuto anche senza JS -->
      <div id="feed">
        <div class="post">
          <div class="posthead">
            <span class="author">Redazione ERMES</span>
            <span>Aggiornamento live</span>
          </div>
          <div class="text">
            Il liveblog è attivo. I commenti compariranno qui in tempo reale durante la serata.
          </div>
        </div>
      </div>

      <div class="empty" id="empty" style="display:none;">
        Live attivo: in attesa dei prossimi aggiornamenti.
      </div>
    </div>
  </div>

  <script>
    const FEED_URL = "https://script.google.com/macros/s/AKfycbyphzTqR3v5KpxMSriPuaea9fekfP9VfLZqxephU0rYrDdIwH06aVJacmetgklcabN_/exec";

    const feedEl = document.getElementById("feed");
    const statusEl = document.getElementById("status");
    const reloadBtn = document.getElementById("reload");
    const emptyEl = document.getElementById("empty");
    const schemaEl = document.getElementById("live-schema");

    let lastSignature = "";

    function esc(str){
      return String(str).replace(/[&<>"']/g, m => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[m]));
    }

    function formatTime(raw){
      if (!raw) return "";
      const d = new Date(raw);
      if (isNaN(d.getTime())) return "";
      const ore = String(d.getHours()).padStart(2,"0");
      const min = String(d.getMinutes()).padStart(2,"0");
      return ore + ":" + min;
    }

    function updateSchemaDateModified(){
      if (!schemaEl) return;
      try{
        const obj = JSON.parse(schemaEl.textContent);
        obj.dateModified = new Date().toISOString();
        schemaEl.textContent = JSON.stringify(obj);
      }catch(e){
        // se per qualche motivo non è JSON valido, non blocchiamo la pagina
      }
    }

    async function loadFeed(){
      try{
        statusEl.innerHTML = `<span class="dot"></span><span>Aggiornamento…</span><span class="liveBadge">LIVE</span>`;

        const res = await fetch(FEED_URL + "?t=" + Date.now(), { cache: "no-store" });
        const text = await res.text();

        let data;
        try { data = JSON.parse(text); }
        catch { throw new Error("Risposta non JSON dal feed"); }

        const posts = data.posts || [];

        if (!posts.length){
          feedEl.innerHTML = "";
          emptyEl.style.display = "block";
          statusEl.innerHTML = `<span class="dot"></span><span>Online • in attesa di aggiornamenti</span><span class="liveBadge">LIVE</span>`;
          updateSchemaDateModified();
          return;
        }

        emptyEl.style.display = "none";

        const newest = posts[0];
        const signature = (newest.time || "") + "|" + (newest.author || "") + "|" + (newest.text || "");
        const isNew = lastSignature && signature !== lastSignature;

        feedEl.innerHTML = posts.map((p, idx) => {
          const highlight = (idx === 0 && isNew) ? "new" : "";
          return `
            <div class="post ${highlight}">
              <div class="posthead">
                <span class="author">${esc(p.author || "Redazione")}</span>
                <span>${esc(formatTime(p.time))}</span>
              </div>
              <div class="text">${esc(p.text || "")}</div>
            </div>
          `;
        }).join("");

        if (isNew) window.scrollTo({ top: 0, behavior: "smooth" });

        lastSignature = signature;

        statusEl.innerHTML = `<span class="dot"></span><span>Online • Ultimo update: ${new Date().toLocaleTimeString()}</span><span class="liveBadge">LIVE</span>`;

        updateSchemaDateModified();
      }catch(e){
        statusEl.innerHTML = `<span class="dot"></span><span>Errore feed: ${esc(e.message)}</span><span class="liveBadge">LIVE</span>`;
        feedEl.innerHTML = `<div class="post"><div class="text">Errore feed:\n${esc(e.message)}</div></div>`;
        emptyEl.style.display = "none";
        console.error("Liveblog error:", e);
      }
    }

    reloadBtn.addEventListener("click", loadFeed);

    loadFeed();
    setInterval(loadFeed, 20000);
  </script>
</body>
</html>
